"use strict";const e=require("../../common/vendor.js"),o=require("../../stores/tabStore.js"),t=require("../../stores/userInfoStore.js"),a=require("../../api/shopCard/shopCard.js");if(!Array){(e.resolveComponent("custom-header")+e.resolveComponent("van-image")+e.resolveComponent("custom-channel-tap")+e.resolveComponent("uni-icons")+e.resolveComponent("van-swipe-cell")+e.resolveComponent("z-paging")+e.resolveComponent("custom-shop-tabbar"))()}Math||((()=>"../../components/custom-header/custom-header.js")+(()=>"../../components/custom-channel-tap/custom-channel-tap.js")+(()=>"../../uni_modules/uni-icons/components/uni-icons/uni-icons.js")+(()=>"../../uni_modules/z-paging/components/z-paging/z-paging.js")+(()=>"../../components/custom-shop-tabbar/custom-shop-tabbar.js"))();const n={__name:"shopCar",setup(n){const s=e.ref(null),i=e.ref([]);e.ref(!1),e.ref([{isImage:!0,style:{backgroundColor:"#F3F2F6"}}]);const l=e.ref([{id:1,name:"华为Mate 60 RS 非凡大师 16GB+1TB",selected:!1,taps:"国行丨全网通丨有保丨电池99%丨深圳发货",price:"14120"},{id:2,name:"华为Mate 60 RS 非凡大师 16GB+1TB 玄黑（全网通）",selected:!1,taps:"国行丨全网通丨有保丨电池99%丨深圳发货",price:"14120"},{id:3,name:"华为Mate 60 RS 非凡大师 16GB+1TB 玄黑（全网通）",selected:!1,taps:"国行丨全网通丨有保丨电池99%丨深圳发货",price:"14120"},{id:4,name:"华为Mate 60 RS 非凡大师 16GB+1TB 玄黑（全网通）4",selected:!1,taps:"国行丨全网通丨有保丨电池99%丨深圳发货",price:"14120"},{id:5,name:"华为Mate 60 RS 非凡大师 16GB+1TB 玄黑（全网通）5",selected:!1,taps:"国行丨全网通丨有保丨电池99%丨深圳发货",price:"14120"},{id:6,name:"华为Mate 60 RS 非凡大师 16GB+1TB 玄黑（全网通）6",selected:!1,taps:"国行丨全网通丨有保丨电池99%丨深圳发货",price:"14120"},{id:7,name:"华为Mate 60 RS 非凡大师 16GB+1TB 玄黑（全网通）7",selected:!1,taps:"国行丨全网通丨有保丨电池99%丨深圳发货",price:"14120"},{id:8,name:"华为Mate 60 RS 非凡大师 16GB+1TB 玄黑（全网通）8",selected:!1,taps:"国行丨全网通丨有保丨电池99%丨深圳发货",price:"14120"}]),r=e.ref([]),c=e=>r.value.includes(e),d=e.ref(!1);e.watchEffect((()=>{d.value=r.value.length>0&&r.value.length===m.value.filter((e=>"1"==e.zt)).length}));const u=()=>{console.log("Before toggle:",r.value,d.value),console.log("shoppingcartlists",m.value),d.value?(r.value=[],d.value=!1):(r.value=m.value.filter((e=>"1"==e.zt)).map((e=>e.id)),d.value=!0),console.log("After toggle:",r.value,d.value)},p=e.computed((()=>{let e=0;for(const o of m.value)c(o.id)&&(e+=parseInt(o.goodinfos.price));return e})),g=()=>{0!==r.value.length&&e.index.showModal({title:"提示",content:"确定要删除选中的商品吗？",success:e=>{if(e.confirm){const e=r.value.join(",");m.value=m.value.filter((e=>!c(e.id))),r.value=[],f(e),s.value.reload(!0)}}})},f=async o=>{const n={opid:e.index.getStorageSync("sessionInfo").opid,id:o};if(200===(await a.apiDeleteShopCard(n)).code){const e=await t.useUserStore().refreshShopCarCount();console.log("刷新购物车:",JSON.parse(e))}};e.computed((()=>l.value.some((e=>e.selected))));const m=e.ref([]),v=o=>{e.index.navigateTo({url:o})},x=()=>{let o=e.ref({lx:"",id:""});const t=m.value.filter((e=>r.value.includes(e.id)));console.log("selectedItems:",t);let a=e.ref();a.value=t.map((e=>e.goodsid)).join(","),console.log("goodsIds:",a),o.value.lx="2",o.value.id=a.value;let n=encodeURIComponent(JSON.stringify(o.value));console.log("dataParam:",o.value),t.length>0?e.index.navigateTo({url:"/pagesSubOrder/subOrder/subOrder?data="+n}):e.index.showToast({title:"请先选择商品",icon:"none",duration:2e3})},h=async(o,t)=>{console.log("pageNo:",o),console.log("pageSize:",t);const n=await(async()=>{const o={opid:e.index.getStorageSync("sessionInfo").opid},t=await a.apigetShopCard(o);return"200"===t.code&&(m.value=t.Shoppingcartlists),console.log(t),m.value})();console.log("data:",n),s.value.complete(n)};return e.onShow((()=>{o.useTabStore().setCurrentTabIndex(1)})),(o,t)=>({a:e.f(e.unref(i),((o,t,a)=>e.e({a:"1"!==o.zt},(o.zt,{}),{b:"7b6ca599-3-"+a+",7b6ca599-2-"+a,c:e.p({width:"190rpx",height:"190rpx",radius:"18rpx",src:o.goodinfos.cover,fit:"fill"}),d:e.o((e=>v("/pagesProductDetail/productDetail/productDetail?id="+o.goodinfos.id)),o.id),e:"1"===o.goodinfos.zjlx},"1"===o.goodinfos.zjlx?{f:"7b6ca599-4-"+a+",7b6ca599-2-"+a,g:e.p({text1:"官方质检",text1Color:"#E6432E",text2:o.goodinfos.finenessname,backgroundColor:"linear-gradient( 132deg, #D94C24 0%, #FF5221 100%)"})}:{},{h:"2"===o.goodinfos.zjlx},"2"===o.goodinfos.zjlx?{i:"7b6ca599-5-"+a+",7b6ca599-2-"+a,j:e.p({text1:"授权质检",text1Color:"#246C14",text2:o.goodinfos.finenessname,backgroundColor:"linear-gradient( 135deg, #246B13 0%, #39D591 100%)"})}:{},{k:"3"===o.goodinfos.zjlx},"3"===o.goodinfos.zjlx?{l:"7b6ca599-6-"+a+",7b6ca599-2-"+a,m:e.p({text1:"自由货源",text1Color:"#FF6C27",text2:o.goodinfos.finenessname,backgroundColor:"linear-gradient( 135deg, #FF6A27 0%, #FEB82E 100%) "})}:{},{n:e.t(o.goodinfos.name),o:e.o((e=>v("/pagesProductDetail/productDetail/productDetail?id="+o.goodinfos.id)),o.id),p:e.t(o.goodinfos.gjbbname),q:e.t(o.goodinfos.wlbbname),r:e.t(o.goodinfos.gjbbname),s:e.t(o.goodinfos.efficiency),t:e.t(o.goodinfos.delivery),v:e.o((e=>v("/pagesProductDetail/productDetail/productDetail?id="+o.goodinfos.id)),o.id),w:e.t(o.goodinfos.price),x:e.o((e=>v("/pagesProductDetail/productDetail/productDetail?id="+o.goodinfos.id)),o.id),y:"1"==o.zt},"1"==o.zt?{z:c(o.id)?"https://www.xzxskj.com/xcximg/icon_xuanze_sel@3x.png":"https://www.xzxskj.com/xcximg/icon_xuanze_nor@3x.png",A:e.o((e=>(e=>{const o=r.value.indexOf(e);-1!==o?r.value.splice(o,1):r.value.push(e),console.log("selectIds.push:",r.value)})(o.id)),o.id)}:{},{B:e.o((t=>{return a=o.id,void e.index.showModal({title:"提示",content:"确定要删除商品吗？",success:e=>{if(e.confirm){m.value=m.value.filter((e=>e.id!==a));const e=r.value.indexOf(a);-1!==e&&r.value.splice(e,1),f(a),s.value.reload(!0)}}});var a}),o.id),C:"7b6ca599-7-"+a+",7b6ca599-2-"+a,D:"7b6ca599-2-"+a+",7b6ca599-1",E:o.id}))),b:e.p({type:"trash",size:"50"}),c:e.p({rightWidth:"59"}),d:e.sr(s,"7b6ca599-1",{k:"paging"}),e:e.o(h),f:e.o((o=>e.isRef(i)?i.value=o:null)),g:e.p({fixed:!1,"show-refresher-update-time":!0,modelValue:e.unref(i)}),h:e.unref(d)?"https://www.xzxskj.com/xcximg/icon_xuanze_sel@3x.png":"https://www.xzxskj.com/xcximg/icon_xuanze_nor@3x.png",i:e.o(u),j:e.o(g),k:e.t(e.unref(p)),l:e.o(x)})}},s=e._export_sfc(n,[["__scopeId","data-v-7b6ca599"]]);wx.createPage(s);
