"use strict";const e=require("../../common/vendor.js"),a=require("../../stores/menuPermissionStore.js"),o=require("../../utils/system.js"),n=require("../../api/product/product.js"),i=require("../../stores/locationStore.js"),s=require("../../stores/tabStore.js"),r=require("../../utils/debounce.js");if(!Array){(e.resolveComponent("transition-group")+e.resolveComponent("custom-shop-tabbar")+e.resolveComponent("z-paging")+e.resolveComponent("uni-popup"))()}const t=()=>"../../components/custom-shop-tabbar/custom-shop-tabbar.js",u=()=>"../../uni_modules/z-paging/components/z-paging/z-paging.js",l=()=>"../../uni_modules/uni-popup/components/uni-popup/uni-popup.js";Math||(e.unref(m)+t+u+e.unref(c)+l+e.unref(d)+e.unref(f))();const d=()=>"./components/jixing.js",c=()=>"./components/saixuan.js",m=()=>"./components/productCard.js",f=()=>"./components/productEditPrice.js",p={__name:"product",setup(t){const u=()=>e.index.navigateBack(),l=async()=>{try{c.value=[],m.value=[];const e=await n.apiGetProductFilterList({ModelID:$.value.ModelID});"200"===e.code&&d(e)}catch(e){console.error("Error fetching data:",e)}},d=e=>{const a=[{name:"系统",id:"3",items:[{id:"1",name:"苹果"},{id:"2",name:"安卓"}]},{name:"分类",id:"1",items:e.classlist},{name:"品牌",id:"2",items:e.brandlist},{name:"资检渠道",id:"9",items:v()},{name:"成色",id:"6",items:e.finenesslist},{name:"内存",id:"7",items:e.memorylist},{name:"颜色",id:"8",items:e.colourlist},{name:"版本",id:"5",items:e.versionlist},{name:"价格",id:"4",items:p()},{name:"其他",id:"10",items:g()}];if($.value.ModelID){const a=[{name:"资检渠道",id:"9",items:v()},{name:"成色",id:"6",items:e.finenesslist},{name:"内存",id:"7",items:e.memorylist},{name:"颜色",id:"8",items:e.colourlist},{name:"版本",id:"5",items:e.versionlist},{name:"价格",id:"4",items:p()}];c.value=a.map((e=>({...e,items:e.items.map((e=>({...e,selected:!1})))})))}else c.value=a.map((e=>({...e,items:e.items.map((e=>({...e,selected:!1})))})));m.value=e.colourlist.map((e=>({...e,selected:!1})))},c=e.ref([]),m=e.ref([]),f=e.ref([]),p=()=>[{id:"1",name:"0-1000"},{id:"2",name:"1001-2000"},{id:"3",name:"2001-3000"},{id:"4",name:"3001-4000"},{id:"5",name:"4001-5000"},{id:"6",name:"5000以上"}],v=()=>[{id:"1",name:"官方质检"},{id:"2",name:"授权质检"},{id:"3",name:"自由货源"}],g=()=>[{id:"1",name:"只看特价"},{id:"2",name:"只看折叠"}],y=e.computed((()=>a.usePermissionStore().hasMenuAuthority("updategoods")&&""!==e.index.getStorageSync("adminId"))),b=e.ref(!1),h=e.ref(!1),j=e.ref(!0);e.ref("");const x=e.ref(null),S=e.ref(""),k=e.ref(!0),I=e.ref(null),w=e.ref(null),P=e.ref(null),z=e.ref(),M=e.ref(),D=e.ref(["最新上架","距离最优"]),L=e.ref(""),C=e.ref({fullLocation:"",province:"",city:"",region:"",postCode:"",longitude:"",latitude:"",name:""}),$=e.ref({brandid:"",classid:"",colourid:"",delivery:"",finenessid:"",gd:"",memoryid:"",newarrivals:"",price:"",pricesdesc:"",sftj:"",sfzd:"",start:"",systemid:"",versionid:"",ModelID:""}),q=e.computed((()=>"不限"!==C.value.region?C.value.region:"不限"!==C.value.city?C.value.city:"不限"!==C.value.province?C.value.province:"全国")),_=async(e,a)=>{$.value.start=e-1;const o=K($),n=await o;x.value.complete(n)},T=(e,a)=>{if(console.log("selected",e),console.log("selectedTabs",a),e.length>0||a.size){const o=e.map((e=>e.id));A(a,o,e)}else console.log("重置了？"),$.value.ModelID="",$.value.sfzd="",$.value.sftj="",L.value="商品列表";x.value.reload(!0),l()},A=(e,a,o)=>{$.value.ModelID=e.has("全部机型")?"":a.join(","),$.value.sfzd=e.has("折叠机型")?"1":"",$.value.sftj=e.has("特价机型")?"1":"",L.value=1===e.size||o.length>1?"商品列表":o[0].xhname},B=e=>{e&&(console.log("param.value",$.value),console.log("data.value",e),$.value={...$.value,...e},console.log("param.value",$.value)),x.value.reload(!0)},E=e=>{const[a,o,n]=e.detail.value;C.value={...C.value,province:a,city:o,region:n,fullLocation:`${a} ${o} ${n}`},$.value.delivery=`${a},${o},${n}`,x.value.reload(!0)},F=e=>{M.value=D.value[e.detail.value],$.value.newarrivals=0===e.detail.value?"1":"2",$.value.pricesdesc="",x.value.reload(!0)},G=()=>{k.value=!k.value,$.value.pricesdesc=k.value?"1":"2",$.value.newarrivals="",x.value.reload(!0)},R=()=>{e.index.showLoading({title:"加载中",mask:!0})},H=()=>{e.index.hideLoading()},O=r.debounce((()=>{R(),b.value=!0,I.value.open(),setTimeout((()=>H()),800)}),1e3,!0),V=r.debounce((()=>{R(),j.value=!0,w.value.open(),setTimeout((()=>H()),800)}),1e3,!0),X=e=>{z.value=e,h.value=!0,P.value.open()},J=()=>{w.value.close(),I.value.close(),P.value.close()};e.onLoad((async e=>{C.value=await i.useLocationStore().getForm(),Object.assign($.value,{ModelID:e.id||"",sftj:e.sftj||"",sfzd:e.sfzd||"",classid:e.classid||"",newarrivals:e.newarrivals||""}),L.value=e.title||"商品列表",$.value.delivery=`${C.value.province},${C.value.city},${C.value.region}`,l()})),e.onShow((()=>{a.usePermissionStore().loadMenuAuthority(),s.useTabStore().setCurrentTabIndex(0)}));const K=async a=>{const o=await n.apiGetProductFilterData(a.value);if("200"!==o.code)return[];const i=o.goodslists,s=e.index.getStorageSync("adminId"),r=e.index.getStorageSync("selectedMine"),t=e.index.getStorageSync("identityData");if(s&&r&&t){const e=t[r];return i.map((a=>({...a,mineCompany:a.gsid===e.gsid})))}return i};return(a,n)=>e.e({a:e.unref(o.getStatusBarHeight)()+"px",b:e.o(u),c:e.t(e.unref(L)),d:e.o(u),e:e.unref(o.getTitleBarHeight)()+"px",f:e.unref(o.getLeftIconLeft)()+"px",g:e.unref(S),h:e.o((a=>e.isRef(S)?S.value=a.detail.value:null)),i:e.unref(q)},e.unref(q)?{j:e.t(e.unref(q))}:{},{k:e.o(E),l:e.unref(q),m:e.unref(D),n:e.o(F),o:e.unref(M),p:e.o(((...a)=>e.unref(O)&&e.unref(O)(...a))),q:e.unref(k)},e.unref(k)?{r:e.unref(k)?"":1}:{},{s:!e.unref(k)},e.unref(k)?{}:{t:e.unref(k)?"":1},{v:!e.unref(k)},e.unref(k)?{}:{w:e.unref(k)?"":1},{x:e.unref(k)},e.unref(k)?{y:e.unref(k)?"":1}:{},{z:e.p({name:"flip"}),A:e.o(G),B:e.o(((...a)=>e.unref(V)&&e.unref(V)(...a))),C:e.f(e.unref(f),((a,o,n)=>({a:e.o(X,o),b:o,c:"f08c6a37-2-"+n+",f08c6a37-0",d:e.p({showSetting:e.unref(y),good:a})}))),D:e.sr(x,"f08c6a37-0",{k:"paging"}),E:e.o(_),F:e.o((a=>e.isRef(f)?f.value=a:null)),G:e.p({"default-page-size":20,"show-refresher-update-time":!0,modelValue:e.unref(f)}),H:e.unref(j)},e.unref(j)?{I:e.o(B),J:e.o(J),K:e.p({filterList:e.unref(c),colorItems:e.unref(m)})}:{},{L:e.sr(w,"f08c6a37-4",{k:"saiXuanPannelPopup"}),M:e.o(J),N:e.o(a.change),O:e.p({"background-color":"rgba(0,0,0,0)","is-mask-click":!0,"safe-area":!1,type:"bottom"}),P:e.unref(b)},e.unref(b)?{Q:e.sr("jixingPannelRef","f08c6a37-7,f08c6a37-6"),R:e.o(T),S:e.o(J),T:e.p({modelId:e.unref($).ModelID})}:{},{U:e.sr(I,"f08c6a37-6",{k:"jixingPopup"}),V:e.o(J),W:e.o(a.change),X:e.p({"background-color":"rgba(0,0,0,0)","is-mask-click":!0,"safe-area":!1,type:"bottom"}),Y:e.unref(h)},e.unref(h)?{Z:e.o(B),aa:e.o(J),ab:e.p({selectedGood:e.unref(z)})}:{},{ac:e.sr(P,"f08c6a37-8",{k:"productEditPricePopup"}),ad:e.o(J),ae:e.o(a.change),af:e.p({"background-color":"rgba(0,0,0,0)","is-mask-click":!0,"safe-area":!1,type:"bottom"})})}},v=e._export_sfc(p,[["__scopeId","data-v-f08c6a37"]]);wx.createPage(v);
