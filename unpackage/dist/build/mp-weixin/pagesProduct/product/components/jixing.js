"use strict";const e=require("../../../common/vendor.js"),a=require("../../../api/classitify/classtify.js");if(!Array){(e.resolveComponent("uv-tabs")+e.resolveComponent("z-paging"))()}Math||((()=>"../../../uni_modules/uv-tabs/components/uv-tabs/uv-tabs.js")+(()=>"../../../uni_modules/z-paging/components/z-paging/z-paging.js"))();const l={__name:"jixing",props:{modelId:{type:String,default:""}},emits:["reload4Jx","close"],setup(l,{emit:o}){const i=l,s=e.ref("xlname");e.ref(!1);const t=e.ref(null),n=e.ref([]),r=e.ref(0),d=e.ref(0),u=e.ref(-1),c=e.ref(["全部机型","折叠机型","特价机型"]),v=e.ref([]),g=e.ref(new Set),p=e.ref(new Set),m=e=>g.value.has(e),b=()=>{g.value.clear(),p.value.clear()},x=e=>p.value.has(e),f=async(a,l)=>{console.log("pageNo:",a),console.log("pageSize:",l),E.value.start=a-1;const o=await S(E);console.log("data:",o);let i=[];if(o)if(1===a)i=o;else{i=[...v.value.reduce(((e,a)=>[...e,...a.products]),[]),...o]}else i=[];e.nextTick$1((()=>{t.value.complete(o)}));const s={};i.forEach((e=>{s[e.xlname]||(s[e.xlname]=[]),s[e.xlname].push(e)})),v.value=Object.entries(s).map((([e,a])=>({name:e,products:a}))),j(),console.log(v.value)},A=e=>{console.log("分类标签切换触发:",e.index),void 0!==e.index?(d.value=e.index,E.value.classid=y.value[d.value].id,E.value.brandid="",E.value.seriesid="",r.value=0,u.value=-1,k()):console.error("标签索引错误或标签数据不存在")},h=e=>{console.log("系列切换了标签:",e.index),void 0!==e.index?(u.value=e.index,E.value.seriesid=C.value[u.value].id,E.value.brandid=B.value[r.value].id,k()):console.error("标签索引错误")},y=e.ref([]),B=e.ref([]),C=e.ref([]);e.ref([]);const E=e.ref({classid:"1",brandid:"1",seriesid:"",start:"0"}),S=async e=>{const l={classid:e.value.classid,brandid:e.value.brandid,seriesid:e.value.seriesid,start:e.value.start},o=await a.apiGetClasstify(l);if("200"===o.code){y.value=o.classlist,B.value=o.brandlist,C.value=o.serieslist;return o.marquelist.sort(((e,a)=>parseInt(e.xlid)-parseInt(a.xlid)))}return!1},W=o,z=()=>{const e=Array.from(g.value);console.log("selected",e),console.log("selectedTabs",p.value),console.log("selectedItems",g.value),W("reload4Jx",e,p.value),W("close")},j=()=>{if(i.modelId){i.modelId.split(",").forEach((e=>{const a=v.value.flatMap((e=>e.products)).find((a=>a.id===e.trim()));a&&g.value.add(a)})),console.log("Initialized selected items:",Array.from(g.value))}},k=()=>{e.nextTick$1((()=>{t.value&&t.value.reload(!0)}))};return e.onShow((()=>{console.log("show")})),(a,l)=>({a:e.o((e=>a.$emit("close"))),b:e.f(c.value,((a,l,o)=>({a:e.t(a),b:l,c:x(a)?1:"",d:e.o((e=>(e=>{console.log("item",e),"全部机型"===e?p.value.has(e)?p.value.delete(e):(p.value.add(e),g.value.clear()):p.value.has(e)?p.value.delete(e):p.value.add(e),console.log("selectedTabs:",p.value)})(a)),l)}))),c:e.o(A),d:e.p({list:y.value,lineColor:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAXCAYAAACmnHcKAAAAAXNSR0IArs4c6QAABHFJREFUWEfdV19oW2UU/51zb5Kma9euTVL0SZn/KCLDJulwLVTaZPoyEKwUZDKn+DBEmD4Mp4LIFNmLg8FQ2PRFHFLUaVUw6VwRNmnS+ocOdQiiIErbxNm1a5t7c78jX7bUNDa5Sdk68L6EfN853/n9zvl959xL+B89VOQiABEg2YHu7YpVDwR+Ap0PJFMf3Wi+pdjyLL0s0qCIpjoSqVOl2Ipk9K9Mx6NvMvAEAANXyFkCZM1Gq3PLqe/+vkGkKmMTyRiiOttGJ+c0tpXKzMYj7zYaxqOLjlqFmYmglPo2kEyHCVi9uUHsXLBNBJPpyAqZzM5wVITPAGishE8gz4cS6dc3CP9KmOlYeAcTjwJoWCs2AXkRPBZMpk4WKpOJR54R0JHSSpU7imCpyaY7GsfGf98oQtLV5cm0GSeYsLuSJLRyIDjUnhh/qUBmOh7Zx8BRgLgSUC8TckqdDWbV/TQ5aW8EoWy8+2GDMWwrqRiONRfBq4FE6sUrlXkgEhFFWmabqoH0MWtCny5YjYO3jo0tX09CmVj0IYF8QERUmUoBQU4Eu0PJ1PC/DSAW+dhg3uVIdddCa4G8F8iqPderQjPx8F6AjhHI55owwW/BZOqWVd3sTB/Mu73RDBO1KBdCm00D83nnbcehgx2nx6ddA9Zo8EdfV8Bj0uM+0zxsKQWXisBvMBYtZyh0Ov3+KjL6z0z/vb0e0/OVbg9uz1XJ/Qil9gVHJ8bc7N32M7HIHkW038d0j1XljhTP8RDBEnUhlEjfVVxbkZlekMFBY2bu12Mm6Kl6BooIThiX6Nn28fFLbqDL92f7w0Ni0CGTeKubxMt8HQNqW1ti4vyaZPTixb5trXmv9xMvU28tGdI+uko6K0uOOg5SHxqGMdXWND9Dwz9YxUC6zWZbvCExnJvA6BAlvQA92WQa7UtKwU3a/xkVSvaGRtPvlK6vqkxxY3bXjmbk7M8biHuWVe018jDB1ukl+YXAWSGxoJDTDV9EmgFqAxD0MrVoIeeVuN6LMhLS6jFpzsq/EEimXisnuCYZbfTXQFeLQ8Y5InS636B6xbU+ey8RbCUHAsnU4bVOqEim0BBi3bcTyYiP+c5cHRVaH9TKXnqSO5AciXo6mJw8XsmyKhntNN3f3WGwHN1k8uBC2UvotQa91nn6zcNyxCZWPYEvJlLVYrqSWblHscgrRHQAgHcjZFcYzgJbgCQtzg0Fz16Yd0tezWQKshuIPMKM5zzM0byg7g7kBkbv6yaiQVlKvgTkSDCRHqnFT9vURabYGATmgEPqLb9htNfT7aqB8jJDS2rBdj4jyBvtreY5Gv56qVYi6yJTenhmZ/igKN4PKnwH+elqctxkWJJBLaNlQBYgcjKwOP8y1SCndTcAt8zoYXgxYGxXCvcBEhWirSSyRYhaGdjcbBqFWaLHz2VH5QH8KZCfCPheKZnyML4pneJu8a5JA6glyM8P3uYLLDX5l/3kMRWbLGzaINPHLPp7wWORbfuWLTH58s0jk4u1nFmPzT/Acc8nAVrxrAAAAABJRU5ErkJggg==') 100% 100%",lineWidth:"25",lineHeight:"8",fontSize:32,activeStyle:{color:"#303133",fontWeight:"bold"},current:d.value}),e:e.f(B.value,((a,l,o)=>({a:e.t(a.name),b:l,c:l===r.value?1:"",d:e.o((e=>(e=>{r.value=e,E.value.brandid=B.value[e].id,E.value.seriesid="",u.value=-1,k()})(l)),l)}))),f:"700rpx",g:e.o(h),h:e.p({list:C.value,lineWidth:"0",lineHeight:"0",fontSize:24,keyName:s.value,activeStyle:{padding:"0 10rpx",fontSize:"28rpx",backgroundColor:"#FFEEEC",color:"#ED5446",fontWeight:"bold",backGround:"#FFEEEC",borderRadius:"4rpx 4rpx 4rpx 4rpx"},inactiveStyle:{padding:"0 10rpx",fontSize:"24rpx",backgroundColor:"#F2F3F6",borderRadius:"4rpx 4rpx 4rpx 4rpx",opacity:.6},current:u.value}),i:e.f(v.value,((a,l,o)=>({a:e.t(a.name),b:e.f(a.products,((a,l,o)=>({a:e.t(a.xhname),b:l,c:m(a)?1:"",d:e.o((l=>(a=>{p.value.has("全部机型")?e.index.showToast({title:"已选择全部机型，不能选择单个型号",icon:"none"}):g.value.has(a)?g.value.delete(a):g.value.add(a)})(a)),l)}))),c:l}))),j:e.sr(t,"82ebde6b-2",{k:"paging"}),k:e.o(f),l:e.o((e=>n.value=e)),m:e.p({"show-refresher-update-time":!0,"default-page-size":20,fixed:!1,modelValue:n.value}),n:e.o(b),o:e.o(z)})}},o=e._export_sfc(l,[["__scopeId","data-v-82ebde6b"]]);wx.createComponent(o);
