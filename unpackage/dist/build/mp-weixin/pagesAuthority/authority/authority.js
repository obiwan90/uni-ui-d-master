"use strict";const e=require("../../common/vendor.js"),o=require("../../api/station/station.js");if(!Array){(e.resolveComponent("custom-header")+e.resolveComponent("mosowe-tree"))()}Math||((()=>"../../components/custom-header/custom-header.js")+(()=>"../../uni_modules/mosowe-tree/components/mosowe-tree/mosowe-tree.js"))();const a={__name:"authority",setup(a){const t=e.ref(),n=e.ref("新建岗位"),l=e.ref(null),s=e.ref([]),i=e.ref([]),r=e.ref(""),d=e=>e.map((e=>{let o=e.lists?d(e.lists):[];return{id:e.id,name:e.name,url:e.url,permission:e.permission,children:o,hide:"1"===e.hide}})).filter((e=>!e.hide)),u=e=>{console.log("节点点击:",e),console.log("数据",s.value)};e.ref("");const c=e.ref([]),v=()=>{(async()=>{const a={opid:JSON.parse(e.index.getStorageSync("userInfo")).opid,name:t.value,qxid:r.value,gwid:h.value};200===(await o.apiStationEdit(a)).code&&(e.index.showToast({title:"保存成功",icon:"none"}),e.index.navigateBack())})()},f=()=>{(async()=>{const a={opid:JSON.parse(e.index.getStorageSync("userInfo")).opid,name:t.value,qxid:r.value};200===(await o.apiStationAdd(a)).code&&(e.index.showToast({title:"保存成功",icon:"none"}),e.index.navigateBack())})()},h=e.ref();return e.onMounted((()=>{(async()=>{const e=await o.apiGetAuthority();200===e.code&&(c.value=e.lists,s.value=d(e.lists))})(),h.value&&(async e=>{const a=await o.apiStationDetail({gwid:e});200===a.code&&(t.value=a.infos.name,a.lists.forEach((e=>{e.checked&&i.value.push(e.id)})))})(h.value),e.watch((()=>i.value),(e=>{let o=[...e];if(l.value){let e=l.value.getHalfCheck();console.log("halfCheckedNodes:",e),e&&0!==e.halfNodeKeys.length&&e.halfNodeKeys.forEach((e=>{o.includes(e)||o.push(e)}))}console.log("finalCheckedValues:",o),r.value=o.join(","),console.log("选中的值:",r.value)}),{deep:!0})})),e.onLoad((e=>{e.forEdit&&(h.value=e.forEdit,n.value="修改岗位")})),(o,a)=>e.e({a:e.t(n.value),b:e.p({backgroundColor:"#FFFFFF"}),c:t.value,d:e.o((e=>t.value=e.detail.value)),e:e.sr(l,"e0ff86f9-1",{k:"mosoweTreeRef"}),f:e.o(u),g:e.o((e=>i.value=e)),h:e.p({height:"10000rpx",accordion:!0,data:s.value,label:"name",value:"id","show-checkbox":!0,modelValue:i.value}),i:"新建岗位"===n.value},"新建岗位"===n.value?{j:e.o(f)}:{k:e.o(v)})}},t=e._export_sfc(a,[["__scopeId","data-v-e0ff86f9"]]);wx.createPage(t);
