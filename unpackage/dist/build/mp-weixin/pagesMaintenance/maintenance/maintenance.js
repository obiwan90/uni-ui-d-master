"use strict";const e=require("../../common/vendor.js"),n=require("../../utils/debounce.js"),a=require("../../utils/common.js"),t=require("../../utils/system.js"),o=require("../../stores/tabStore.js"),r=require("../../api/maintenance/maintenanceApi.js"),i=require("../../stores/tokenStore.js");if(!Array){(e.resolveComponent("uv-tabs")+e.resolveComponent("uni-popup"))()}Math||((()=>"../../uni_modules/uv-tabs/components/uv-tabs/uv-tabs.js")+(()=>"../../uni_modules/uni-popup/components/uni-popup/uni-popup.js"))();const s={__name:"maintenance",setup(s){e.ref(!0);const u=e.ref(),l=e.ref(null);o.useTabStore();const c=e.ref([]),f=e.ref(0),d=e.ref();e.ref("0");const p=()=>{e.index.navigateBack()},v=e.ref(0),m=e.ref(0),x=e.index.getSystemInfoSync(),g=750/x.windowWidth,h=x.windowHeight*g,y=(n,a)=>{e.index.createSelectorQuery().select(n).boundingClientRect((e=>{const n=e.top*g;a.value=Math.max(0,h-n-175)})).exec()};e.onMounted((()=>{y(".main-l",v),y(".main-r",m)})),e.onMounted((async()=>{try{await Promise.all([q(1),L(1)]),y(".main-l",v),y(".main-r",m)}catch(e){console.error("请求失败:",e)}}));const b=()=>{e.index.showModal({title:"温馨提示",content:"所有查询结果仅供参考，若查询结果与官网不一致，则以官网为准；查询结果无法作为权威质检证明，且不具备任何法律效力。",showCancel:!1,confirmText:"确定",confirmColor:"#FF7744"})},w=()=>{e.index.scanCode({scanType:["barCode"],success:function(e){switch(console.log("条码类型："+e.scanType),console.log("条码内容："+e.result),e.scanType){case"QR_CODE":case"EAN_13":case"barCode":case"datamatrix":case"pdf417":break;default:e.scanType}u.value=e.result}})},F=e.ref(),S=e.ref(),j=e.ref(),k=e.ref(),T=e.ref([]),C=e.ref(),_=e.ref([]),q=async e=>{const n={brand_id:e,opid:i.useTokenStore().opid},a=await r.apiGetBrand(n);F.value=a.allinfos,S.value=a.ejlists,j.value=a.navlist,d.value=j.value[0].id},L=async n=>{e.index.getStorageSync("queryMaintenanceHisList");const a={opid:i.useTokenStore().opid};C.value=await r.apiGetmaintenanceHis(a);const t=C.value&&C.value.querlists;if(!t)return _.value=null,[];_.value=t},M=n.debounce((async()=>{if(e.index.showLoading({title:"Loading",mask:!0}),!u.value)return e.index.showModal({content:"请输入序列号或者条形码",showCancel:!1,confirmText:"确定"}),void e.index.hideLoading();const n={word:u.value,lxid:d.value,opid:i.useTokenStore().opid};k.value=await r.apiCheackMaintenance(n),"200"!==k.value.code&&(e.index.hideLoading(),e.index.showToast({title:"未查询到内容",icon:"error",duration:2e3})),console.log("checkResult",JSON.stringify(k.value)),T.value=B(),console.log("checkList",JSON.stringify(T.value)),e.index.hideLoading()}),500),B=()=>{const e=k.value&&k.value.infos;return e?Object.keys(e).map((n=>({id:n,...e[n]}))):(k.value=null,[])},H=e=>{console.log("切换了.."+e.index),e.index,q(S.value[e.index].id)};return(n,o)=>e.e({a:e.unref(t.getStatusBarHeight)()+"px",b:e.o(p),c:e.o(p),d:e.o(b),e:e.unref(t.getTitleBarHeight)()+"px",f:e.unref(t.getLeftIconLeft)()+"px",g:e.unref(u),h:e.o((n=>e.isRef(u)?u.value=n.detail.value:null)),i:e.o(w),j:e.o(((...n)=>e.unref(M)&&e.unref(M)(...n))),k:e.o(H),l:e.p({list:e.unref(S),lineWidth:"30",lineColor:"#f56c6c",fontSize:32,activeStyle:{fontWeight:"bold",color:"#303133"},inactiveStyle:{color:"#606266"}}),m:e.unref(F)},e.unref(F)?{n:e.t(e.unref(F).price)}:{},{o:e.f(e.unref(j),((n,a,t)=>({a:e.t(n.name),b:e.t(n.free),c:e.t(n.price),d:a,e:a===e.unref(f)?"linear-gradient(270deg, #FFD0BE 0%, #FFFFFF 100%)":"#ffffff",f:e.o((e=>(e=>{c.value[e]="linear-gradient(270deg, #FFD0BE 0%, #FFFFFF 100%)",f.value!==e&&(c.value[f.value]="#ffffff"),c.value=[...c.value],f.value=e,d.value=j.value[e].id,L(d.value)})(a)),a)}))),p:e.unref(v)+"rpx",q:e.unref(k)||e.unref(_)},e.unref(k)||e.unref(_)?e.e({r:e.unref(k)},e.unref(k)?{s:e.t(e.unref(k).cxmc),t:e.t(e.unref(k).cxsj),v:e.f(e.unref(T),((n,a,t)=>({a:e.t(n.names),b:e.t(n.values),c:n.id})))}:{},{w:e.unref(_)},e.unref(_)?{x:e.f(e.unref(_),((n,t,o)=>({a:e.t(n.cxmc),b:e.o((e=>(e=>{let n="";for(const a in e)if(e.hasOwnProperty(a)){const t=e[a];n+=`${t.names}：${t.values}，`}n=n.replace(/，/g,"，\n"),a.copyText(n)})(n.fhnrss)),t),c:e.t(n.timess),d:e.f(n.fhnrss,((n,a,t)=>({a:e.t(n.names),b:e.t(n.values),c:a}))),e:t})))}:{},{y:e.unref(m)+"rpx"}):{},{z:e.o(((...e)=>n.share&&n.share(...e))),A:e.sr(l,"358a5d52-1",{k:"popup"}),B:e.p({type:"center"})})}},u=e._export_sfc(s,[["__scopeId","data-v-358a5d52"]]);wx.createPage(u);
