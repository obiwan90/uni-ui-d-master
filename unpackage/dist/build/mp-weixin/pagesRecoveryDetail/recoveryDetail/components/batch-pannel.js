"use strict";const e=require("../../../common/vendor.js"),o=require("../../../api/recovery/recovery.js");if(!Array){(e.resolveComponent("uv-scroll-list")+e.resolveComponent("van-stepper")+e.resolveComponent("uni-popup-dialog")+e.resolveComponent("uni-popup"))()}Math||((()=>"../../../uni_modules/uv-scroll-list/components/uv-scroll-list/uv-scroll-list.js")+(()=>"../../../uni_modules/uni-popup/components/uni-popup-dialog/uni-popup-dialog.js")+(()=>"../../../uni_modules/uni-popup/components/uni-popup/uni-popup.js"))();const a={__name:"batch-pannel",props:{param:{type:Object,default:{}},selectData:{type:Object,default:{}}},emits:["close"],setup(a,{emit:n}){const l=e.ref(null),p=e.ref(!1),u=e.ref({}),t=()=>{p.value=!1,console.log("close"),l.value.close()},r=async e=>{u.value.price=e,v.value.forEach((o=>{o.djname==u.value.djname&&(o.price=e)})),l.value.close(),p.value=!1},i=e.ref(""),c=e=>{i.value=e},s=n,d=a,m=d.param,v=e.ref([]),f=e.ref([]),b=e.ref([]),j=e.ref([]),x=e.ref(""),g=e.ref(-1),h=async()=>{console.log(d.param);const e=await o.apiBatchEdit(m);200==e.code&&(v.value=e.djlist,f.value=e.nclist,b.value=e.yslist,j.value=e.bblist,x.value=e.name,e.lx?i.value=e.lx:i.value="1",g.value=f.value.findIndex((e=>e.name===d.param.nc))),console.log(e)},y=e.computed((()=>v.value.map((e=>e.price)).join(","))),_=e.computed((()=>v.value.map((e=>e.djid)).join(","))),C=e.computed((()=>{let e="";for(let o=0;o<b.value.length;o++){let a=b.value[o],n=a.name;a.price&&(n+=a.price),o>0&&(e+=","),e+=n}return e})),w=()=>{(async()=>{const a={xhid:d.param.xhid,ppid:d.param.ppid,nc:m.nc,bb:d.param.bb||"",bx:d.param.bx||"",djid:_.value,djprice:y.value,ysinfos:C.value,lx:i.value},n=await o.apiBatchEditSubmit(a);200==n.code&&(e.index.showToast({title:"修改成功",icon:"none"}),setTimeout((()=>{s("close"),e.index.$emit("recoveryDetailRefresh")}),1e3)),console.log(n)})()};return e.onMounted((()=>{h()})),(o,a)=>e.e({a:e.o((e=>o.$emit("close"))),b:e.t(e.unref(x)),c:"2"===e.unref(i)},(e.unref(i),{}),{d:e.o((e=>c("1"))),e:"1"===e.unref(i)},(e.unref(i),{}),{f:e.o((e=>c("2"))),g:e.f(e.unref(f),((o,a,n)=>({a:e.t(o.name),b:e.o((e=>{return o=a,g.value=o,m.nc=f.value[o].name,void h();var o}),a),c:e.unref(g)===a?1:"",d:a}))),h:e.p({indicator:!1}),i:e.f(e.unref(v),((o,a,n)=>({a:e.t(o.djname),b:e.t(o.price),c:e.o((e=>(e=>{u.value=e,p.value=!0,l.value.open()})(o)),a),d:a}))),j:e.f(e.unref(b),((o,a,n)=>({a:e.t(o.name),b:e.o((e=>((e,o)=>{console.log("onChange:",e.detail),o.price=e.detail})(e,o)),a),c:"a64931d2-2-"+n+",a64931d2-1",d:e.p({value:""===o.price||""===o.price?"0":o.price,min:-1e4,step:"10",inputWidth:"48rpx",buttonSize:"48rpx"}),e:a}))),k:e.p({indicator:!1}),l:e.o((e=>o.$emit("close"))),m:e.o(w),n:e.unref(p)},e.unref(p)?{o:e.o(t),p:e.o(r),q:e.p({mode:"input",message:"成功消息",title:"输入价格","before-close":!0})}:{},{r:e.sr(l,"a64931d2-3",{k:"popup"}),s:e.p({type:"dialog"})})}},n=e._export_sfc(a,[["__scopeId","data-v-a64931d2"]]);wx.createComponent(n);
