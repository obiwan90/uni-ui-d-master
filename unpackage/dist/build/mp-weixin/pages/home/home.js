"use strict";const e=require("../../common/vendor.js"),o=require("../../stores/initFinished.js");require("../../stores/tokenStore.js");const s=require("../../stores/userInfoStore.js"),n=require("../../api/product/product.js"),t=require("../../api/home/home.js"),a=require("../../stores/tabStore.js");if(!Array){(e.resolveComponent("custom-navi-bar")+e.resolveComponent("custom-product-card")+e.resolveComponent("custom-tabbar")+e.resolveComponent("z-paging")+e.resolveComponent("uni-popup"))()}Math||((()=>"../../components/custom-navi-bar/custom-navi-bar.js")+(()=>"../../components/custom-product-card/custom-product-card.js")+(()=>"../../components/custom-tabbar/custom-tabbar.js")+(()=>"../../uni_modules/z-paging/components/z-paging/z-paging.js")+i+(()=>"../../uni_modules/uni-popup/components/uni-popup/uni-popup.js"))();const i=()=>"../../components/QRCodeModal/QRCodeModal.js",r={__name:"home",setup(i){o.useInitFinishedStore().initFinished;const r=e.ref([]),u=e.ref([]),c=e.ref(!1),l=e.ref("https://www.xzxskj.com/logo/logo.jpg"),d=e.ref(null),p=e.ref(!1),g=e.ref(null),m=e.ref({brandid:"",classid:"",colourid:"",delivery:"",finenessid:"",gd:"",memoryid:"",newarrivals:"1",price:"",pricesdesc:"",sftj:"",sfzd:"",start:0,systemid:"",versionid:"",ModelID:"",pageSize:20}),f=()=>{console.log("Popup is closed"),d.value.close()},v=async(e,o)=>{console.log("pageNo:",e),console.log("pageSize:",o),m.value.start=e-1,m.value.pageSize=o;const s=await n.apiGetProductFilterData(m.value);g.value.complete(s.goodslists||[])},y=async o=>{if(console.log("path",o),p.value)return;p.value=!0;const s="pagesClassify/classify/classify"===o?`/${o}?res=${encodeURIComponent(JSON.stringify(null))}`:`/${o}`;console.log("url",s),e.index.navigateTo({url:s}),setTimeout((()=>{p.value=!1}),1e3)},h=async()=>{var o;const s=e.index.getStorageSync("sessionInfo"),n={opid:s.opid,unionid:s.unionid},a=await t.apiHomeMenus(n);return"200"===a.code&&(u.value=a.dhlist,c.value=!(null==(o=a.usinfos)?void 0:o.gzhopid)&&2==a.zt,console.log("关注",c.value),d.value&&(c.value?d.value.open():d.value.close())),a},b=async o=>{const s=e.Vs.database(),n=await s.collection("user-setting").where({user_id:o.id}).get();if(console.log("userSetting",n),n.result.data.length>0){const{adminLx:o,adminId:s,identityData:t,selectedMine:a}=n.result.data[0];e.index.setStorageSync("adminLx",o),e.index.setStorageSync("adminId",s),e.index.setStorageSync("identityData",t),e.index.setStorageSync("selectedMine",a)}return n.result.data};return e.onShow((async()=>{a.useTabStore().setCurrentTabIndex(0),await h(),g&&g.value&&g.value.refresh(!0)})),e.onReady((()=>{setTimeout((()=>{s.useUserStore().getInfo().then((e=>Promise.all([h(),b(e)])))}),1e3)})),(s,n)=>e.e({a:!e.unref(o.useInitFinishedStore)().initFinished},e.unref(o.useInitFinishedStore)().initFinished?e.e({b:e.unref(u)},e.unref(u)?{c:e.f(e.unref(u),((o,s,n)=>e.e({a:"0"===o.hide},"0"===o.hide?{b:"https://www.xzxskj.com"+o.imgs,c:e.t(o.name),d:e.o((e=>y(o.urls)),s)}:{},{e:s})))}:{},{d:e.o((e=>y("pagesClassify/classify/classify"))),e:e.o((e=>y("pagesRecovery/recovery/recovery"))),f:e.o((e=>y("pagesProduct/product/product?newarrivals=1"))),g:e.f(e.unref(r),((o,s,n)=>({a:o.id,b:"9c45bf90-2-"+n+",9c45bf90-0",c:e.p({good:o})}))),h:e.sr(g,"9c45bf90-0",{k:"paging"}),i:e.o(v),j:e.o((o=>e.isRef(r)?r.value=o:null)),k:e.p({"loading-more-enabled":!0,"loading-more-default-text":!0,"show-loading-more-when-reload":!0,"default-page-size":20,modelValue:e.unref(r)}),l:e.p({qrCodeUrl:e.unref(l)}),m:e.sr(d,"9c45bf90-4",{k:"officialAccountPopup"}),n:e.o(f),o:e.o(s.change),p:e.p({"background-color":"rgba(0,0,0,0)","is-mask-click":!1,"safe-area":!1,type:"center"})}):{})}},u=e._export_sfc(r,[["__scopeId","data-v-9c45bf90"]]);wx.createPage(u);
