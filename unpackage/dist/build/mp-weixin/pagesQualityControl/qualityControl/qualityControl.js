"use strict";const e=require("../../common/vendor.js"),t=require("../../utils/common.js"),o=require("../../api/qualityControl/qualityControl.js"),n=require("../../stores/menuPermissionStore.js");if(!Array){(e.resolveComponent("custom-header")+e.resolveComponent("van-overlay")+e.resolveComponent("z-paging")+e.resolveComponent("uni-popup"))()}const a=()=>"../../uni_modules/uni-popup/components/uni-popup/uni-popup.js";Math||((()=>"../../components/custom-header/custom-header.js")+r+(()=>"../../uni_modules/z-paging/components/z-paging/z-paging.js")+e.unref(u)+a)();const r=()=>"../../uni_modules/qiao-select/components/qiao-select/qiaoSelect.js",u=()=>"./components/qualitySaixuan.js",l={__name:"qualityControl",setup(a){const r=e.getCurrentInstance(),u=e.ref("ch"),l=e.ref("ch"),s=e.ref(null),i=async()=>{c();try{const e=await t.scanCode();console.log("result",e),e&&k(e).then((()=>{j.value.length>0&&(s.value.inputText=j.value[0].ch)}))}catch(e){console.error("扫码失败：",e)}finally{p()}},c=()=>{e.index.showLoading({title:"加载中...",mask:!0})},p=()=>{e.index.hideLoading()},f=n.usePermissionStore(),g=e.ref(null),d=e.ref(!1),m=()=>{console.log("Popup is closed"),g.value.close()},h=e=>{e.show||(d.value=e.show)},x=()=>{d.value=!0,g.value.open()};e.ref(null);const v=e.ref(null),y=e.ref([]),w=async(e,t)=>{console.log("pageNo:",e),console.log("pageSize:",t);const o=await X($);console.log("data:",o),v.value.complete(o)},j=e.ref([]),k=async t=>{if(t.length>0){e.index.showLoading({title:"加载中....",mask:!0}),console.log("inputText",t),$.value.ch=t;const o=await X($);console.log("search data",o),j.value=o,e.index.hideLoading()}},C=e=>{e&&(console.log("selectSearchChange e:",e),v.value.complete([e]))},q=e.ref(["今日","昨日","本月","上月"]),P=e.computed((()=>q.value.filter(((e,t)=>4!==t)))),_=e.ref("时间区间"),z=e.ref(0),A=e.ref("开始时间"),I=e.ref("截止时间"),T=e=>{console.log(e),A.value=e.detail.value},L=e=>{console.log(e),I.value=e.detail.value},Q=e.ref(!1),b=e.ref(!1),F=()=>{b.value=!b.value,Q.value=!0,z.value=-1},M=e.ref(["修改日志","查看报告"]);e.ref(!1);const R=e.ref(0),S=e.ref(0),J=e.ref(0),B=e.ref([]),D=e.ref([{text:"商品录入",image:"https://www.xzxskj.com/xcximg/icon_luru@3x.png",path:"/pagesProductInput/productInput/productInput?from=QC",menuAuthority:"productInput"},{text:"功能检测",image:"https://www.xzxskj.com/xcximg/icon_gnjc@3x.png",path:"/pagesFuncCheck/funcCheck/funcCheck?from=QC",menuAuthority:"funcCheck"},{text:"维修检测",image:"https://www.xzxskj.com/xcximg/icon_wxjc@3x.png",path:"/pagesMaintenanceInput/maintenanceInput/maintenanceInput?from=QC",menuAuthority:"maintenanceInput"},{text:"图片修改",image:"https://www.xzxskj.com/xcximg/icon_luru@3x.png",path:"/pagesTakePhoto/takePhoto/takePhoto?from=QC",menuAuthority:"takePhoto"},{text:"成色判断",image:"https://www.xzxskj.com/xcximg/icon_gnjc@3x.png",path:"/pagesFinenessJudge/finenessJudge/finenessJudge?from=QC",menuAuthority:"finenessJudge"},{text:"修改价格",image:"https://www.xzxskj.com/xcximg/icon_wxjc@3x.png",path:"/pagesListingProduct/listingProduct/listingProduct?from=QC",menuAuthority:"listingProduct"}]),E=t=>{e.nextTick$1((()=>{e.index.createSelectorQuery().select("#dropdown-trigger"+t).boundingClientRect().exec((e=>{S.value=e[0].top,R.value=e[0].height,J.value=e[0].left,console.log("triggerTop:",S.value),console.log("triggerHeight:",R.value),console.log("triggerLeft:",J.value)}))}))},K=()=>{B.value.forEach(((e,t)=>{B.value[t]=!1}))},$=e.ref({lx:"1",startTime:"",endTime:"",cgyid:"",wxjcid:"",gnjcid:"",splrid:"",start:0,ch:""}),H=e.ref([]),N=e.ref([]),V=e.ref([]),G=e.ref([]),O=e.ref(0),U=e.ref(0),W=e.ref(0),X=async e=>{const t=await o.apiQualityControlList(e.value);return console.log("res:",t),1===t.zt?(H.value=t.cgyglist,N.value=t.gnjcarrays,V.value=t.splrarrays,G.value=t.wxjcarrays,O.value=t.gnjccount,U.value=t.splrcount,W.value=t.wxjccount,t.lists):[]};return e.onMounted((()=>{B.value=new Array(12).fill(!1)})),(o,n)=>e.e({a:e.p({backgroundColor:"#FFFFFF"}),b:e.sr(s,"28007df8-2,28007df8-0",{k:"myInputRef"}),c:e.o(k),d:e.o(C),e:e.p({keyId:1,dataList:e.unref(j),phText:"搜索串号",searchKey:"name",showBorder:!1,disabled:!1,searchKey:e.unref(u),showField:e.unref(l)}),f:e.o(i),g:e.o(x),h:e.f(e.unref(P),((t,o,n)=>({a:e.t(t),b:e.o((e=>(e=>{z.value=e,b.value=!1,Q.value=!1,$.value.lx=e+1,v.value.reload(!0)})(o)),o),c:e.unref(z)===o?1:"",d:o}))),i:e.t(e.unref(_)),j:e.o(F),k:e.unref(Q)?1:"",l:e.t(e.unref(A)),m:e.o(T),n:e.unref(A),o:e.t(e.unref(I)),p:e.o(L),q:e.unref(I),r:e.unref(b),s:e.unref(b)?1:"",t:e.unref(f).hasMenuAuthority("qualityData")},e.unref(f).hasMenuAuthority("qualityData")?{v:e.t(e.unref(U)),w:e.t(e.unref(O)),x:e.t(e.unref(W))}:{},{y:e.f(e.unref(y),((o,n,a)=>e.e({a:e.t(e.unref(t.formatTimestamp)(o.servicetime)),b:e.t(o.name),c:e.t(o.ch),d:e.o((t=>e.unref(r).proxy.copyText(o.ch)),n),e:e.t(o.cgyname),f:e.t(o.splr),g:e.t(o.gnjcname),h:e.t(o.wxjcname)},e.unref(f).hasMenuAuthority("updateQuality")?{i:"dropdown-trigger"+n,j:e.o((e=>(e=>{B.value[e]=!B.value[e],E(e)})(n)),n)}:{},{k:e.f(e.unref(D),((t,n,a)=>({a:t.image,b:e.t(t.text),c:n,d:e.o((n=>((t,o)=>{e.index.navigateTo({url:t.path+"&ch="+o})})(t,o.ch)),n)}))),l:e.o(K,n),m:"28007df8-4-"+a+",28007df8-3",n:e.p({show:e.unref(B)[n]}),o:e.f(e.unref(M),((t,n,a)=>({a:e.t(t),b:n,c:e.o((n=>((t,o)=>{console.log("Button clicked:",t),"修改日志"===t&&e.index.navigateTo({url:"/pagesEditLog/editLog/editLog?id="+o.id}),"查看报告"===t&&e.index.navigateTo({url:"/pagesQualityReport/qualityReport/qualityReport?ch="+o.ch})})(t,o)),n)}))),p:n}))),z:e.unref(f).hasMenuAuthority("updateQuality"),A:`${e.unref(J)+24}px`,B:`${e.unref(S)+e.unref(R)+12}px`,C:e.sr(v,"28007df8-3,28007df8-0",{k:"paging"}),D:e.o(w),E:e.o((t=>e.isRef(y)?y.value=t:null)),F:e.p({"show-refresher-update-time":!0,fixed:!1,modelValue:e.unref(y)}),G:e.sr(v,"28007df8-0",{k:"paging"}),H:e.o(w),I:e.o((t=>e.isRef(y)?y.value=t:null)),J:e.p({"show-refresher-update-time":!0,modelValue:e.unref(y)}),K:e.unref(d)},e.unref(d)?{L:e.o(m),M:e.p({cgyglist:e.unref(H),gnjcarrays:e.unref(N),splrarrays:e.unref(V),wxjcarrays:e.unref(G)})}:{},{N:e.sr(g,"28007df8-5",{k:"saixuanPannelPopup"}),O:e.o(m),P:e.o(h),Q:e.p({"background-color":"rgba(0,0,0,0)","is-mask-click":!0,"safe-area":!1,type:"bottom"})})}},s=e._export_sfc(l,[["__scopeId","data-v-28007df8"]]);wx.createPage(s);
