"use strict";const e=require("../../../common/vendor.js"),i=require("../../../utils/common.js"),t=require("../../api/api.js"),a=require("../../../utils/debounce.js");if(!Array){e.resolveComponent("van-uploader")()}const o={__name:"offline-payment-pannel",props:{ddxx:{type:Array,default:[]},totalPrice:{type:Number,default:0}},emits:["reload"],setup(o,{emit:n}){const l=n,s=o;console.log("totalPrice:",s.totalPrice);const c=e.ref([{name:"支付宝",id:"2",selected:!0,img:"https://www.xzxskj.com/xcximg/icon_zhifubao@3x.png"},{name:"微信",id:"1",selected:!1,img:"https://www.xzxskj.com/xcximg/icon_weixin@3x.png"},{name:"收款码",id:"3",selected:!1,img:"https://www.xzxskj.com/xcximg/icon_qita@3x.png"},{name:"银行卡",id:"4",selected:!1,img:"https://www.xzxskj.com/xcximg/icon_card@3x.png"},{name:"现金",id:"5",selected:!1,img:"https://www.xzxskj.com/xcximg/icon_xianjin@3x.png"},{name:"其他",id:"6",selected:!1,img:"https://www.xzxskj.com/xcximg/icon_qita@3x.png"}]),d=e.ref(s.totalPrice||0),r=e.ref(""),u=e.ref(c.value.find((e=>e.selected))||c.value[0]),m=()=>{console.log("选中的支付方式:",u.value),g()},x=e.ref([]),p={fileList:x},v=(e,t)=>{i.uploadFiles(e,t,p)},g=async i=>{if(console.log("ddxx",s.ddxx),0===x.value.length)return void e.index.showToast({title:"请上传至少一张图片",icon:"none",duration:2e3});if(d.value<=0)return void e.index.showToast({title:"金额必须大于0",icon:"none",duration:2e3});const t={id:JSON.stringify(s.ddxx),zffs:u.value.id,remarks:r.value,imgs:x.value.map((e=>e.url)).join(", "),price:d.value};await f(t)},f=a.debounce((async e=>{await w(e)}),400,!0),w=async i=>{const a=await t.fpbkSubmit(i);"200"===a.code?(e.index.showToast({title:"操作成功",icon:"success",duration:500}),setTimeout((()=>{l("reload")}),500)):e.index.showToast({title:a.msg||"操作失败",icon:"error",duration:500})};return(t,a)=>({a:e.o((e=>t.$emit("close"))),b:d.value,c:e.o((e=>d.value=e.detail.value)),d:u.value.img,e:e.t(u.value.name),f:e.f(c.value,((i,t,a)=>e.e({a:i.img,b:e.t(i.name),c:i.selected},(i.selected,{}),{d:e.o((e=>(e=>{c.value.forEach(((i,t)=>{i.selected=t===e})),u.value=c.value[e]})(t)),t),e:t}))),g:r.value,h:e.o((e=>r.value=e.detail.value)),i:e.o((e=>{return t=e,void i.uploadCheack(t);var t})),j:e.o((e=>((e,t)=>{i.uploadDelete(e,t,p)})(e,"fileList"))),k:e.p({fileList:x.value,accept:"image",maxCount:"3",maxSize:"5242880",previewSize:"162rpx",afterRead:e=>(e=>{v(e,"fileList")})(e)}),l:e.o(m)})}},n=e._export_sfc(o,[["__scopeId","data-v-edbfedb8"]]);wx.createComponent(n);
